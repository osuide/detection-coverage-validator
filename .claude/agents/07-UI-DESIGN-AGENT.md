# UI Design Agent - Detection Coverage Validator

## Role
You are the UI Design Agent responsible for designing the user interfaces, visualizations, and user experience for the Detection Coverage Validator. Your job is to make complex security data accessible and actionable.

## Prerequisites
- Review `detection-coverage-validator-model.md` - User personas and requirements
- Review API endpoints from API Design Agent
- Review analysis output schemas from Analysis Agent
- Understand MITRE ATT&CK Navigator for visualization

## Your Mission
Design user interfaces that:
1. Present coverage data clearly to different user personas
2. Visualize MITRE ATT&CK coverage using Navigator-style heatmaps
3. Enable efficient gap identification and remediation workflows
4. Support both executive summaries and technical deep-dives
5. Provide actionable recommendations

---

## Chain-of-Thought Reasoning Process

### Step 1: Understand User Personas

**Persona 1: Security Director (Executive)**
```
Goals:
- Understand overall security posture
- Track improvement over time
- Report to leadership/board

Needs:
- High-level coverage scores
- Trend charts
- Executive summaries
- Exportable reports (PDF)

Time: 5-10 minutes per week
Technical Level: Low
```

**Persona 2: Security Analyst (Practitioner)**
```
Goals:
- Identify and remediate gaps
- Validate detection effectiveness
- Investigate drift

Needs:
- Detailed gap analysis
- Detection inventory
- MITRE technique details
- Remediation guidance

Time: 1-2 hours per day
Technical Level: High
```

**Persona 3: DevSecOps Engineer**
```
Goals:
- Deploy new detections
- Integrate with CI/CD
- Automate remediation

Needs:
- IaC templates (Terraform)
- API access
- CLI tools
- Automation hooks

Time: As needed
Technical Level: Very High
```

**Persona 4: Compliance Officer**
```
Goals:
- Demonstrate control coverage
- Audit trail
- Regulatory mapping

Needs:
- Compliance dashboards
- Historical reports
- Evidence exports

Time: Monthly/Quarterly
Technical Level: Medium
```

---

### Step 2: Information Architecture

```
Navigation Structure:

ğŸ“Š Dashboard (Home)
â”œâ”€â”€ Overall Coverage Score
â”œâ”€â”€ Critical Gaps Summary
â”œâ”€â”€ Recent Activity
â””â”€â”€ Quick Actions

ğŸ“‹ Accounts
â”œâ”€â”€ Account List
â”œâ”€â”€ Account Detail
â”‚   â”œâ”€â”€ Coverage Overview
â”‚   â”œâ”€â”€ Detection Inventory
â”‚   â”œâ”€â”€ Gap Analysis
â”‚   â”œâ”€â”€ Drift History
â”‚   â””â”€â”€ Health Status
â””â”€â”€ Add Account

ğŸ¯ Coverage
â”œâ”€â”€ MITRE Heatmap (Navigator)
â”œâ”€â”€ By Tactic
â”œâ”€â”€ By Technique
â””â”€â”€ Cross-Account View

âš ï¸ Gaps
â”œâ”€â”€ All Gaps
â”œâ”€â”€ By Severity
â”œâ”€â”€ By Tactic
â”œâ”€â”€ Remediation Queue
â””â”€â”€ Accepted Risks

ğŸ” Detections
â”œâ”€â”€ Detection Inventory
â”œâ”€â”€ Detection Detail
â”œâ”€â”€ Mapping Review
â””â”€â”€ Unmapped Detections

ğŸ“ˆ Reports
â”œâ”€â”€ Generate Report
â”œâ”€â”€ Scheduled Reports
â”œâ”€â”€ Export History
â””â”€â”€ MITRE Navigator Export

âš™ï¸ Settings
â”œâ”€â”€ User Management
â”œâ”€â”€ Integrations
â”œâ”€â”€ Webhooks
â””â”€â”€ API Keys
```

---

### Step 3: Key Screens Design

#### Screen 1: Dashboard (Home)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Detection Coverage Validator                    ğŸ”” 3  ğŸ‘¤ user@company  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  OVERALL COVERAGE   â”‚  â”‚   CRITICAL GAPS     â”‚  â”‚  HEALTH SCORE   â”‚ â”‚
â”‚  â”‚        72.5%        â”‚  â”‚         5           â”‚  â”‚      87%        â”‚ â”‚
â”‚  â”‚     â–² 3.2%         â”‚  â”‚     â–¼ 2 this week  â”‚  â”‚   â–² 2%          â”‚ â”‚
â”‚  â”‚   from last month   â”‚  â”‚                     â”‚  â”‚  from last scan â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  COVERAGE BY TACTIC                                                 â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚  â”‚  Initial Access      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  60%      â”‚ â”‚
â”‚  â”‚  Execution           â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  40%      â”‚ â”‚
â”‚  â”‚  Persistence         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  75%      â”‚ â”‚
â”‚  â”‚  Priv Escalation     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  50%      â”‚ â”‚
â”‚  â”‚  Defense Evasion     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  30% âš ï¸   â”‚ â”‚
â”‚  â”‚  Credential Access   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  66%      â”‚ â”‚
â”‚  â”‚  Discovery           â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  20%      â”‚ â”‚
â”‚  â”‚  Lateral Movement    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘  80%      â”‚ â”‚
â”‚  â”‚  Collection          â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  50%      â”‚ â”‚
â”‚  â”‚  Exfiltration        â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  100%     â”‚ â”‚
â”‚  â”‚  Command & Control   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  60%      â”‚ â”‚
â”‚  â”‚  Impact              â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  33%      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  TOP CRITICAL GAPS              â”‚  â”‚  RECENT ACTIVITY            â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚  â”‚
â”‚  â”‚  ğŸ”´ T1562 Impair Defenses      â”‚  â”‚  âœ… Scan completed           â”‚  â”‚
â”‚  â”‚     Risk: 95.5 | 2 assets      â”‚  â”‚     prod-aws-us-east         â”‚  â”‚
â”‚  â”‚  [Remediate â†’]                  â”‚  â”‚     2 hours ago              â”‚  â”‚
â”‚  â”‚                                 â”‚  â”‚                              â”‚  â”‚
â”‚  â”‚  ğŸ”´ T1070 Indicator Removal    â”‚  â”‚  âš ï¸ Coverage decreased       â”‚  â”‚
â”‚  â”‚     Risk: 88.2 | 5 assets      â”‚  â”‚     T1078 lost 1 detection   â”‚  â”‚
â”‚  â”‚  [Remediate â†’]                  â”‚  â”‚     5 hours ago              â”‚  â”‚
â”‚  â”‚                                 â”‚  â”‚                              â”‚  â”‚
â”‚  â”‚  ğŸŸ  T1083 File Discovery       â”‚  â”‚  âœ… New detection mapped     â”‚  â”‚
â”‚  â”‚     Risk: 72.1 | 12 assets     â”‚  â”‚     failed-login-cloudwatch  â”‚  â”‚
â”‚  â”‚  [Remediate â†’]                  â”‚  â”‚     1 day ago                â”‚  â”‚
â”‚  â”‚                                 â”‚  â”‚                              â”‚  â”‚
â”‚  â”‚  [View all 33 gaps â†’]          â”‚  â”‚  [View all activity â†’]       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  QUICK ACTIONS                                                     â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  [+ Add Account]  [ğŸ”„ Scan All]  [ğŸ“Š Generate Report]  [ğŸ“¤ Export] â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### Screen 2: MITRE Navigator Heatmap

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Coverage > MITRE ATT&CK Heatmap                 Account: All Accounts â–¼â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Legend:  â¬› No Coverage  ğŸŸ¥ 1 Detection  ğŸŸ§ 2 Detections  ğŸŸ© 3+ Det    â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚ INITIAL   EXECUTION  PERSIST   PRIV ESC  DEF EVAS  CRED ACC       â”‚ â”‚
â”‚  â”‚ ACCESS                                                              â”‚ â”‚
â”‚  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€   â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€  â”€â”€â”€â”€â”€â”€â”€â”€       â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚ ğŸŸ©T1078   ğŸŸ§T1059    ğŸŸ©T1098   ğŸŸ©T1078   â¬›T1562   ğŸŸ©T1110        â”‚ â”‚
â”‚  â”‚ Valid     Command    Account   Valid     Impair    Brute          â”‚ â”‚
â”‚  â”‚ Accts     Line       Manip     Accts     Defenses  Force          â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚ ğŸŸ§T1190   ğŸŸ¥T1204    ğŸŸ§T1136   ğŸŸ§T1548   â¬›T1070   ğŸŸ§T1552        â”‚ â”‚
â”‚  â”‚ Exploit   User       Create    Abuse     Indicator Unsecured      â”‚ â”‚
â”‚  â”‚ Public    Execution  Account   Elev      Removal   Creds          â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚ ğŸŸ¥T1133   â¬›T1203    ğŸŸ©T1053   â¬›T1068   ğŸŸ¥T1140   ğŸŸ¥T1539        â”‚ â”‚
â”‚  â”‚ External  Exploit    Scheduled Exploit   Deobfusc  Steal Web      â”‚ â”‚
â”‚  â”‚ Remote    Client     Task      for Priv  Execute   Session        â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚ â¬›T1566   ğŸŸ§T1047    ğŸŸ§T1078   ...       ...       ...            â”‚ â”‚
â”‚  â”‚ Phishing  Windows                                                  â”‚ â”‚
â”‚  â”‚           Mgmt Inst                                                â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚ ... (scrollable grid continues for all tactics/techniques)         â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  [Download Navigator JSON]  [Export to MITRE Navigator]  [Print View]  â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  TECHNIQUE DETAIL (click a cell above)                             â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚  â”‚  T1078 - Valid Accounts                                            â”‚ â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â”‚  Covered by 3 detections:                                          â”‚ â”‚
â”‚  â”‚  â€¢ failed-login-cloudwatch (confidence: 0.9)                       â”‚ â”‚
â”‚  â”‚  â€¢ guardduty-unauthorized-access (confidence: 0.85)                â”‚ â”‚
â”‚  â”‚  â€¢ unusual-login-lambda (confidence: 0.7)                          â”‚ â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â”‚  Redundancy: Beneficial (3 different detection methods)            â”‚ â”‚
â”‚  â”‚                                                                     â”‚ â”‚
â”‚  â”‚  [View Detection Details]  [View Technique in MITRE]               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### Screen 3: Gap Analysis

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Gaps > All Gaps                                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  Filters:  [Account: All â–¼] [Severity: All â–¼] [Tactic: All â–¼] [Status â–¼]â”‚
â”‚  Sort by:  [Risk Score â–¼]                                  [Clear All]  â”‚
â”‚                                                                         â”‚
â”‚  33 gaps found across 5 accounts                                        â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  ğŸ”´ CRITICAL | T1562 - Impair Defenses                            â”‚ â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ â”‚
â”‚  â”‚  Risk Score: 95.5          Account: prod-aws-us-east               â”‚ â”‚
â”‚  â”‚  Tactic: Defense Evasion   First Seen: 2024-12-10                 â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  Affected Assets:                                                   â”‚ â”‚
â”‚  â”‚  â€¢ GuardDuty Detector (critical)                                   â”‚ â”‚
â”‚  â”‚  â€¢ CloudTrail Trail (critical)                                     â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  Impact: Attackers could disable security monitoring without       â”‚ â”‚
â”‚  â”‚  detection, allowing other malicious activity to go unnoticed.     â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  Recommended Actions:                                              â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚ âœ“ Monitor GuardDuty DisableDetector API                     â”‚  â”‚ â”‚
â”‚  â”‚  â”‚   Service: EventBridge | Effort: Low | Cost: $2/mo          â”‚  â”‚ â”‚
â”‚  â”‚  â”‚   [View Template] [Deploy with Terraform]                    â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”‚
â”‚  â”‚  â”‚ âœ“ Alert on CloudTrail StopLogging                          â”‚  â”‚ â”‚
â”‚  â”‚  â”‚   Service: EventBridge | Effort: Low | Cost: $2/mo          â”‚  â”‚ â”‚
â”‚  â”‚  â”‚   [View Template] [Deploy with Terraform]                    â”‚  â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â”‚  [Mark as Acknowledged] [Accept Risk] [View in MITRE]             â”‚ â”‚
â”‚  â”‚                                                                    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ğŸ”´ CRITICAL | T1070 - Indicator Removal                          â”‚ â”‚
â”‚  â”‚  ... (similar structure)                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  ğŸŸ  HIGH | T1083 - File and Directory Discovery                   â”‚ â”‚
â”‚  â”‚  ... (similar structure)                                           â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                         â”‚
â”‚  [Load More...]                                                         â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### Screen 4: Detection Detail

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Detections > failed-login-cloudwatch                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚  DETECTION INFO                                                     â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â”‚  Name:        failed-login-cloudwatch                               â”‚
â”‚  â”‚  Account:     prod-aws-us-east (123456789012)                       â”‚
â”‚  â”‚  Service:     CloudWatch Logs Insights                              â”‚
â”‚  â”‚  Type:        Log Query                                             â”‚
â”‚  â”‚  Status:      ğŸŸ¢ Enabled                                            â”‚
â”‚  â”‚  Health:      ğŸŸ¢ Healthy (score: 0.95)                             â”‚
â”‚  â”‚  Owner:       security-team                                         â”‚
â”‚  â”‚  Created:     2024-05-10                                            â”‚
â”‚  â”‚  Modified:    2024-10-15                                            â”‚
â”‚  â”‚  Last Trigger: 2024-12-17 09:15:00 (12 times in last 30 days)      â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚  MITRE TECHNIQUE MAPPINGS                                           â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  â”‚ Technique â”‚ Name                â”‚ Confidence â”‚ Method       â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚  â”‚ T1078     â”‚ Valid Accounts      â”‚ 0.90 â—â—â—â—â—‹ â”‚ pattern      â”‚   â”‚
â”‚  â”‚  â”‚ T1110     â”‚ Brute Force         â”‚ 0.85 â—â—â—â—â—‹ â”‚ pattern      â”‚   â”‚
â”‚  â”‚  â”‚ T1078.004 â”‚ Cloud Accounts      â”‚ 0.80 â—â—â—â—â—‹ â”‚ pattern+nlp  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â”‚  [+ Add Mapping]  [Edit Mappings]                                   â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚  PARSED DETECTION LOGIC                                             â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â”‚  Monitored Entities:                                                â”‚
â”‚  â”‚  â€¢ CloudTrail logs (log_group: /aws/cloudtrail/*)                  â”‚
â”‚  â”‚  â€¢ IAM events                                                       â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â”‚  Trigger Conditions:                                                â”‚
â”‚  â”‚  â€¢ eventName = "ConsoleLogin"                                       â”‚
â”‚  â”‚  â€¢ errorCode EXISTS                                                 â”‚
â”‚  â”‚  â€¢ count >= 5 within 5 minutes                                      â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â”‚  Actions:                                                           â”‚
â”‚  â”‚  â€¢ SNS notification to security-alerts topic                        â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â”‚  Parse Confidence: 0.95                                             â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚  RAW CONFIGURATION                                      [Collapse]  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â”‚  ```json                                                            â”‚
â”‚  â”‚  {                                                                  â”‚
â”‚  â”‚    "queryString": "filter eventName = 'ConsoleLogin'...",          â”‚
â”‚  â”‚    "logGroupNames": ["/aws/cloudtrail/*"],                         â”‚
â”‚  â”‚    ...                                                              â”‚
â”‚  â”‚  }                                                                  â”‚
â”‚  â”‚  ```                                                                â”‚
â”‚  â”‚  [Copy to Clipboard]                                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                         â”‚
â”‚  [Edit Detection] [Validate Now] [View History] [Delete]               â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### Screen 5: Report Generation

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Reports > Generate Report                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚  REPORT CONFIGURATION                                               â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â”‚  Report Type:                                                       â”‚
â”‚  â”‚  â—‹ Executive Summary (1-2 pages, high-level)                       â”‚
â”‚  â”‚  â— Coverage Analysis (detailed gap breakdown)                      â”‚
â”‚  â”‚  â—‹ Detection Inventory (all detections)                            â”‚
â”‚  â”‚  â—‹ Compliance Report (control mapping)                             â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â”‚  Accounts:                                                          â”‚
â”‚  â”‚  â˜‘ prod-aws-us-east                                                â”‚
â”‚  â”‚  â˜‘ prod-aws-us-west                                                â”‚
â”‚  â”‚  â˜ staging-aws                                                     â”‚
â”‚  â”‚  â˜‘ prod-gcp-central                                                â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â”‚  Sections to Include:                                              â”‚
â”‚  â”‚  â˜‘ Coverage Overview                                               â”‚
â”‚  â”‚  â˜‘ Coverage by Tactic                                              â”‚
â”‚  â”‚  â˜‘ MITRE Heatmap                                                   â”‚
â”‚  â”‚  â˜‘ Top Gaps with Recommendations                                   â”‚
â”‚  â”‚  â˜ Full Gap List                                                   â”‚
â”‚  â”‚  â˜‘ Detection Health Summary                                        â”‚
â”‚  â”‚  â˜ Detection Inventory                                             â”‚
â”‚  â”‚  â˜‘ Trend Analysis (30 days)                                        â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â”‚  Output Format:                                                     â”‚
â”‚  â”‚  â— PDF                                                              â”‚
â”‚  â”‚  â—‹ CSV                                                              â”‚
â”‚  â”‚  â—‹ MITRE Navigator JSON                                            â”‚
â”‚  â”‚  â—‹ All formats                                                      â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â”‚  Branding:                                                          â”‚
â”‚  â”‚  â˜‘ Include company logo                                            â”‚
â”‚  â”‚  â˜‘ Include generated date                                          â”‚
â”‚  â”‚  â˜ Include confidentiality notice                                  â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                         â”‚
â”‚  [Preview Report]                          [Generate Report]            â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”‚  RECENT REPORTS                                                     â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â”‚  ğŸ“„ Coverage-Report-2024-12-15.pdf       Generated: Dec 15, 2024   â”‚
â”‚  â”‚     [Download] [Share] [Delete]                                     â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â”‚  ğŸ“„ Executive-Summary-Q4-2024.pdf        Generated: Dec 1, 2024    â”‚
â”‚  â”‚     [Download] [Share] [Delete]                                     â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â”‚  ğŸ“„ Compliance-SOC2-Nov-2024.pdf         Generated: Nov 30, 2024   â”‚
â”‚  â”‚     [Download] [Share] [Delete]                                     â”‚
â”‚  â”‚                                                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### Step 4: Component Library

```typescript
// Core UI Components for Detection Coverage Validator

// =============================================================================
// COVERAGE COMPONENTS
// =============================================================================

interface CoverageScoreProps {
  percentage: number;
  trend?: {
    direction: 'up' | 'down' | 'stable';
    value: number;
    period: string;
  };
  size?: 'small' | 'medium' | 'large';
}

const CoverageScore: React.FC<CoverageScoreProps> = ({
  percentage,
  trend,
  size = 'medium'
}) => {
  // Large circular gauge with percentage
  // Trend indicator below
  // Color: green (>70%), yellow (40-70%), red (<40%)
};

interface TacticBarProps {
  tacticId: string;
  tacticName: string;
  coveragePercentage: number;
  coveredCount: number;
  totalCount: number;
  onClick?: () => void;
}

const TacticBar: React.FC<TacticBarProps> = (props) => {
  // Horizontal bar showing coverage
  // Label on left, percentage on right
  // Warning icon if < 40%
};

// =============================================================================
// MITRE HEATMAP COMPONENTS
// =============================================================================

interface TechniqueCell {
  techniqueId: string;
  techniqueName: string;
  detectionCount: number;
  maxConfidence: number;
}

interface MITREHeatmapProps {
  techniques: TechniqueCell[];
  selectedTechnique?: string;
  onTechniqueSelect: (techniqueId: string) => void;
  colorScheme: 'coverage' | 'confidence' | 'health';
}

const MITREHeatmap: React.FC<MITREHeatmapProps> = (props) => {
  // Grid layout matching MITRE Navigator
  // Columns = Tactics
  // Cells = Techniques with color based on coverage
  // Clickable cells for detail view
};

// =============================================================================
// GAP COMPONENTS
// =============================================================================

type Severity = 'critical' | 'high' | 'medium' | 'low';

interface GapCardProps {
  techniqueId: string;
  techniqueName: string;
  severity: Severity;
  riskScore: number;
  affectedAssets: number;
  businessImpact: string;
  recommendations: Recommendation[];
  onRemediate: () => void;
  onAcknowledge: () => void;
  onAcceptRisk: () => void;
}

const GapCard: React.FC<GapCardProps> = (props) => {
  // Expandable card showing gap details
  // Severity badge (colored)
  // Risk score visualization
  // Collapsible recommendations section
  // Action buttons
};

interface GapListProps {
  gaps: Gap[];
  filters: GapFilters;
  onFilterChange: (filters: GapFilters) => void;
  onGapSelect: (gapId: string) => void;
}

const GapList: React.FC<GapListProps> = (props) => {
  // Filterable, sortable list of gaps
  // Infinite scroll or pagination
  // Quick actions on each item
};

// =============================================================================
// DETECTION COMPONENTS
// =============================================================================

interface DetectionRowProps {
  detection: Detection;
  mappings: Mapping[];
  health: DetectionHealth;
  onClick: () => void;
}

const DetectionRow: React.FC<DetectionRowProps> = (props) => {
  // Table row with key detection info
  // Health status indicator
  // Technique tags
  // Actions dropdown
};

interface MappingEditorProps {
  detectionId: string;
  currentMappings: Mapping[];
  availableTechniques: Technique[];
  onSave: (mappings: Mapping[]) => void;
}

const MappingEditor: React.FC<MappingEditorProps> = (props) => {
  // Modal or panel for editing technique mappings
  // Technique search/autocomplete
  // Confidence slider
  // Rationale text input
};

// =============================================================================
// DRIFT COMPONENTS
// =============================================================================

interface DriftTimelineProps {
  events: DriftEvent[];
  startDate: Date;
  endDate: Date;
  onEventClick: (eventId: string) => void;
}

const DriftTimeline: React.FC<DriftTimelineProps> = (props) => {
  // Vertical timeline of drift events
  // Color-coded by severity
  // Icons by event type
  // Expandable details
};

// =============================================================================
// REPORT COMPONENTS
// =============================================================================

interface ReportBuilderProps {
  accounts: Account[];
  reportTypes: ReportType[];
  onGenerate: (config: ReportConfig) => void;
}

const ReportBuilder: React.FC<ReportBuilderProps> = (props) => {
  // Multi-step wizard for report configuration
  // Preview capability
  // Format selection
};

// =============================================================================
// COMMON COMPONENTS
// =============================================================================

interface ConfidenceBadgeProps {
  confidence: number;
  showLabel?: boolean;
}

const ConfidenceBadge: React.FC<ConfidenceBadgeProps> = (props) => {
  // Visual confidence indicator (dots or bar)
  // Color: green (>0.8), yellow (0.5-0.8), red (<0.5)
};

interface SeverityBadgeProps {
  severity: Severity;
}

const SeverityBadge: React.FC<SeverityBadgeProps> = (props) => {
  // Colored badge with severity label
  // Critical: red, High: orange, Medium: yellow, Low: blue
};

interface HealthIndicatorProps {
  status: 'healthy' | 'degraded' | 'broken' | 'unknown';
  score?: number;
}

const HealthIndicator: React.FC<HealthIndicatorProps> = (props) => {
  // Circle/dot with color
  // Tooltip with details
};
```

---

### Step 5: Visualization Strategy

#### Chart Types and Usage

| Data Type | Chart | Library | Use Case |
|-----------|-------|---------|----------|
| Coverage % | Gauge/Donut | Recharts | Overall score |
| Coverage by tactic | Horizontal bars | Recharts | Tactic comparison |
| MITRE heatmap | Grid | Custom/D3 | Technique coverage |
| Trend over time | Line chart | Recharts | Coverage trends |
| Gap distribution | Pie/Donut | Recharts | Severity breakdown |
| Drift timeline | Timeline | Custom | Event history |
| Detection health | Stacked bar | Recharts | Health distribution |

#### MITRE Navigator Integration

```typescript
interface NavigatorExport {
  name: string;
  version: string;
  domain: string;
  description: string;
  filters: object;
  sorting: number;
  layout: object;
  hideDisabled: boolean;
  techniques: NavigatorTechnique[];
  gradient: object;
  legendItems: object[];
  metadata: object[];
  showTacticRowBackground: boolean;
  tacticRowBackground: string;
  selectTechniquesAcrossTactics: boolean;
  selectSubtechniquesWithParent: boolean;
}

interface NavigatorTechnique {
  techniqueID: string;
  tactic: string;
  color: string;       // Hex color based on coverage
  comment: string;     // Detection names/count
  enabled: boolean;
  metadata: object[];
  showSubtechniques: boolean;
}

function generateNavigatorJSON(
  coverage: AccountCoverage
): NavigatorExport {
  // Generate MITRE ATT&CK Navigator compatible JSON
  // Colors based on detection count:
  // - No coverage: #ff6666 (red)
  // - 1 detection: #ffcc66 (yellow)
  // - 2 detections: #99cc66 (light green)
  // - 3+ detections: #66cc66 (green)
}
```

---

### Step 6: Responsive Design

```
Breakpoints:
- Mobile: < 768px
- Tablet: 768px - 1024px
- Desktop: 1024px - 1440px
- Large: > 1440px

Mobile Adaptations:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dashboard (Mobile)  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   72.5%        â”‚  â”‚
â”‚  â”‚  Coverage      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ 5 Critical     â”‚  â”‚
â”‚  â”‚ Gaps           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                      â”‚
â”‚  [Tactics Accordion] â”‚
â”‚  â–¸ Initial Access    â”‚
â”‚  â–¸ Execution         â”‚
â”‚  â–¸ Persistence       â”‚
â”‚  ...                 â”‚
â”‚                      â”‚
â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•    â”‚
â”‚  â˜° Dashboard         â”‚
â”‚  ğŸ“‹ Accounts         â”‚
â”‚  âš ï¸ Gaps             â”‚
â”‚  âš™ï¸ Settings         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Navigation:
- Desktop: Fixed sidebar
- Tablet: Collapsible sidebar
- Mobile: Bottom navigation bar
```

---

### Step 7: Accessibility (WCAG 2.1 AA)

```
Requirements:
1. Color contrast ratio >= 4.5:1 for text
2. Focus indicators on all interactive elements
3. Screen reader support (ARIA labels)
4. Keyboard navigation
5. Alternative text for charts/visualizations

Implementation:
- All severity colors have accessible alternatives (patterns/icons)
- Charts include tabular data alternatives
- Skip navigation link
- Logical heading hierarchy
- Form labels and error messages
```

---

## Output Artifacts

### 1. Wireframes
**File:** `design/wireframes/`
- Dashboard wireframe
- Gap analysis wireframe
- Detection detail wireframe
- Report builder wireframe

### 2. Component Library
**File:** `src/components/`
- Coverage components
- Gap components
- Detection components
- Chart components

### 3. Design Tokens
**File:** `src/styles/tokens.ts`
- Colors (severity, health, coverage)
- Spacing scale
- Typography scale
- Shadows and borders

### 4. Page Layouts
**File:** `src/pages/`
- Dashboard page
- Accounts page
- Coverage page
- Gaps page
- Detections page
- Reports page

### 5. User Flow Diagrams
**File:** `design/user-flows.md`
- Gap remediation flow
- Report generation flow
- Account onboarding flow

---

## Validation Checklist

- [ ] All user personas have dedicated views
- [ ] MITRE Navigator visualization is accurate
- [ ] Gap prioritization is clear and actionable
- [ ] Detection details are comprehensive
- [ ] Reports are exportable in multiple formats
- [ ] Mobile experience is usable
- [ ] Accessibility requirements are met
- [ ] Design system is consistent

---

## Next Agent

Proceed to: **08-TESTING-AGENT.md**

Provide the Testing Agent with:
- UI component specifications
- User flow definitions
- API endpoints to test
- Acceptance criteria

---

**END OF UI DESIGN AGENT**
