# A13E Admin Management Portal - Design Document

**Version:** 1.0.0
**Date:** 2025-12-19
**Author:** Orchestrator CoT Planning
**Status:** DESIGN PHASE

---

## Executive Summary

This document defines the architecture for a secure admin management portal for the A13E Detection Coverage Validator SaaS platform. The portal enables platform operators to manage organizations, monitor system health, view metrics, and respond to security incidents.

**Security is the primary design consideration.** This portal has elevated privileges and must be protected accordingly.

---

## 1. CHAIN OF THOUGHT ANALYSIS

### 1.1 Problem Statement

A SaaS platform requires administrative capabilities beyond what tenant (organization) admins have:
- Platform-wide visibility into all organizations
- Resource utilization monitoring
- Security incident detection and response
- Billing and subscription management
- User/organization troubleshooting

### 1.2 Threat Model for Admin Portal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    THREAT ACTORS                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. External Attackers                                            â”‚
â”‚    - Target: Admin credentials (highest value)                   â”‚
â”‚    - Methods: Phishing, credential stuffing, session hijacking   â”‚
â”‚                                                                  â”‚
â”‚ 2. Malicious Insiders                                            â”‚
â”‚    - Target: Customer data, competitive intelligence             â”‚
â”‚    - Methods: Privilege abuse, data exfiltration                 â”‚
â”‚                                                                  â”‚
â”‚ 3. Compromised Admin Account                                     â”‚
â”‚    - Impact: Full platform compromise                            â”‚
â”‚    - Methods: Lateral movement, persistence                      â”‚
â”‚                                                                  â”‚
â”‚ 4. Supply Chain                                                  â”‚
â”‚    - Target: Admin portal dependencies                           â”‚
â”‚    - Methods: Malicious packages, compromised CDNs               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3 Security Requirements (Non-Negotiable)

| Requirement | Implementation | Priority |
|-------------|----------------|----------|
| **Strong Authentication** | Hardware key MFA required | CRITICAL |
| **Zero Trust Network** | Separate subdomain, IP allowlist | CRITICAL |
| **Principle of Least Privilege** | Role-based access, time-boxed sessions | CRITICAL |
| **Complete Audit Trail** | Log every action with immutable storage | CRITICAL |
| **Defense in Depth** | Multiple security layers | HIGH |
| **Secure by Default** | No implicit permissions | HIGH |

---

## 2. ARCHITECTURE

### 2.1 Deployment Architecture (Separate from Customer-Facing)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     PUBLIC INTERNET                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   CloudFront (WAF + Shield) â”‚
              â”‚   admin.a13e.io             â”‚
              â”‚   âš ï¸ IP ALLOWLIST ONLY      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚   Lambda@Edge               â”‚
              â”‚   - CSP Headers             â”‚
              â”‚   - Security Headers        â”‚
              â”‚   - Request Validation      â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                                   â”‚
          â–¼                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   S3 (Admin SPA)    â”‚             â”‚   API Gateway       â”‚
â”‚   admin.a13e.io     â”‚             â”‚   (Admin API)       â”‚
â”‚   - Separate bucket â”‚             â”‚   - Rate limiting   â”‚
â”‚   - No public accessâ”‚             â”‚   - Request signing â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â–¼
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                    â”‚   ECS Fargate       â”‚
                                    â”‚   (Admin API)       â”‚
                                    â”‚   - Private subnet  â”‚
                                    â”‚   - No internet     â”‚
                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                         â”‚                         â”‚
                    â–¼                         â–¼                         â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚   RDS PostgreSQLâ”‚       â”‚   ElastiCache   â”‚       â”‚   S3 Audit Logs â”‚
          â”‚   (Same DB)     â”‚       â”‚   Redis         â”‚       â”‚   (Immutable)   â”‚
          â”‚   - Encrypted   â”‚       â”‚   - Session mgmtâ”‚       â”‚   - WORM mode   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 Key Architecture Decisions

| Decision | Rationale |
|----------|-----------|
| **Separate Subdomain** | `admin.a13e.io` - different security context, different CSP |
| **IP Allowlist** | Only known admin IPs can reach CloudFront |
| **Shared Database** | Reduce complexity, use row-level security for admin-only tables |
| **Separate S3 Bucket** | Isolation of admin frontend assets |
| **Immutable Audit Logs** | S3 Object Lock for tamper-proof logging |

---

## 3. SECURITY DESIGN

### 3.1 Authentication (Multi-Layer)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ADMIN AUTHENTICATION FLOW                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Layer 1: Network Access                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âœ“ IP must be in allowlist (VPN/office IPs only)          â”‚   â”‚
â”‚  â”‚ âœ“ CloudFront WAF blocks all other traffic                â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â”‚                                     â”‚
â”‚                            â–¼                                     â”‚
â”‚  Layer 2: Primary Authentication                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âœ“ Email/Password with bcrypt (cost factor 12)            â”‚   â”‚
â”‚  â”‚ âœ“ Account lockout after 3 failed attempts (1 hour)       â”‚   â”‚
â”‚  â”‚ âœ“ Password requirements: 16+ chars, complexity           â”‚   â”‚
â”‚  â”‚ âœ“ Password must not be in known breach databases         â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â”‚                                     â”‚
â”‚                            â–¼                                     â”‚
â”‚  Layer 3: Multi-Factor Authentication (REQUIRED)                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âœ“ Hardware security key (WebAuthn/FIDO2) PREFERRED       â”‚   â”‚
â”‚  â”‚ âœ“ TOTP (Authenticator app) as backup only                â”‚   â”‚
â”‚  â”‚ âœ— SMS/Email OTP NOT ALLOWED (SIM swap risk)              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                            â”‚                                     â”‚
â”‚                            â–¼                                     â”‚
â”‚  Layer 4: Session Establishment                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ âœ“ Short-lived JWT (15 minutes)                           â”‚   â”‚
â”‚  â”‚ âœ“ Refresh token in HttpOnly cookie (8 hours)             â”‚   â”‚
â”‚  â”‚ âœ“ Session bound to: IP, User-Agent, Device fingerprint   â”‚   â”‚
â”‚  â”‚ âœ“ Re-authentication required for sensitive actions       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 Authorization (Role-Based with Constraints)

```python
# Admin Role Hierarchy
class AdminRole(Enum):
    SUPER_ADMIN = "super_admin"      # Full access (CEO/CTO only)
    PLATFORM_ADMIN = "platform_admin" # Operations, no billing
    SECURITY_ADMIN = "security_admin" # Security events only
    SUPPORT_ADMIN = "support_admin"   # Read-only, impersonation
    BILLING_ADMIN = "billing_admin"   # Billing only
    READONLY_ADMIN = "readonly_admin" # Dashboards only

# Permission Matrix
ADMIN_PERMISSIONS = {
    "super_admin": ["*"],  # All permissions

    "platform_admin": [
        "org:read", "org:update", "org:suspend",
        "user:read", "user:disable",
        "metrics:read",
        "audit:read",
        "system:health",
    ],

    "security_admin": [
        "audit:read", "audit:export",
        "security:incidents",
        "user:disable",  # Emergency response
        "org:suspend",   # Emergency response
        "metrics:security",
    ],

    "support_admin": [
        "org:read",
        "user:read",
        "user:impersonate",  # With additional controls
        "audit:read:own",    # Only their actions
    ],

    "billing_admin": [
        "billing:read", "billing:update",
        "subscription:read", "subscription:update",
        "invoice:read", "invoice:generate",
    ],

    "readonly_admin": [
        "metrics:read",
        "org:read",
        "system:health",
    ],
}
```

### 3.3 Sensitive Action Controls

```python
# Actions requiring additional verification
SENSITIVE_ACTIONS = {
    # Action: (requires_reauth, requires_approval, max_per_day)
    "org:delete": (True, True, 1),        # Needs 2nd admin approval
    "user:delete": (True, True, 5),       # Needs 2nd admin approval
    "org:suspend": (True, False, 10),     # Re-auth only
    "user:impersonate": (True, False, 5), # Time-limited (30 min)
    "export:all_data": (True, True, 1),   # Needs approval
    "admin:create": (True, True, 1),      # Super admin only + approval
    "admin:delete": (True, True, 1),      # Super admin only + approval
    "billing:refund": (True, False, 10),  # Re-auth only
}

# Impersonation restrictions
IMPERSONATION_RULES = {
    "max_duration_minutes": 30,
    "requires_reason": True,
    "notifies_user": True,           # User gets email
    "creates_audit_entry": True,
    "cannot_change_password": True,
    "cannot_modify_billing": True,
    "cannot_access_api_keys": True,  # Security risk
    "ends_on_sensitive_action": True,
}
```

### 3.4 Audit Logging (Comprehensive)

```python
# Every admin action is logged
class AdminAuditLog:
    """Immutable audit log for admin actions."""

    # Core fields
    id: UUID                    # Unique log ID
    timestamp: datetime         # UTC timestamp
    admin_id: UUID             # Admin who performed action
    admin_email: str           # Denormalized for search
    admin_role: AdminRole      # Role at time of action

    # Action details
    action: str                # e.g., "org:suspend"
    resource_type: str         # e.g., "organization"
    resource_id: UUID          # e.g., org UUID
    resource_name: str         # e.g., "Acme Corp" (for readability)

    # Context
    ip_address: str            # Admin's IP
    user_agent: str            # Browser/client info
    device_fingerprint: str    # Device identification
    geo_location: dict         # Country, city
    session_id: UUID           # Link to session

    # Request details
    request_id: UUID           # Correlation ID
    request_path: str          # API endpoint
    request_method: str        # GET, POST, etc.
    request_body_hash: str     # SHA-256 of request body

    # Response details
    response_status: int       # HTTP status
    success: bool              # Did action succeed
    error_message: Optional[str]

    # Additional context
    reason: Optional[str]      # Why (for sensitive actions)
    approval_id: Optional[UUID] # If required approval
    impersonating_user: Optional[UUID]  # If impersonating

    # Immutability
    log_hash: str              # SHA-256 of all fields
    previous_log_hash: str     # Chain for integrity
```

### 3.5 Data Access Controls

```sql
-- Database-level security for admin tables

-- Admin users table (separate from regular users)
CREATE TABLE admin_users (
    id UUID PRIMARY KEY,
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    role admin_role NOT NULL,
    mfa_secret_encrypted BYTEA,  -- Encrypted with KMS
    webauthn_credentials JSONB,

    -- Security controls
    is_active BOOLEAN DEFAULT true,
    requires_password_change BOOLEAN DEFAULT false,
    locked_until TIMESTAMP,
    failed_login_attempts INTEGER DEFAULT 0,

    -- Audit
    created_at TIMESTAMP DEFAULT NOW(),
    created_by UUID REFERENCES admin_users(id),
    last_login_at TIMESTAMP,
    last_password_change TIMESTAMP,

    -- Constraints
    CONSTRAINT valid_email CHECK (email ~* '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$'),
    CONSTRAINT strong_role CHECK (role IN ('super_admin', 'platform_admin', 'security_admin', 'support_admin', 'billing_admin', 'readonly_admin'))
);

-- Row Level Security for admin audit logs
ALTER TABLE admin_audit_logs ENABLE ROW LEVEL SECURITY;

-- Admins can only read logs, never modify or delete
CREATE POLICY admin_audit_read_only ON admin_audit_logs
    FOR SELECT
    TO admin_api
    USING (true);

-- No update or delete policies = immutable
-- Insert only via specific service role
CREATE POLICY admin_audit_insert ON admin_audit_logs
    FOR INSERT
    TO audit_service
    WITH CHECK (true);
```

---

## 4. FEATURE DESIGN

### 4.1 Dashboard Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  A13E Admin Portal                    [ğŸ”’ admin@a13e.io] [Settings] [â†ª]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    SYSTEM HEALTH                                  â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  API Latency    â”‚  Error Rate   â”‚  Active Scans  â”‚  Queue Depth  â”‚  â”‚
â”‚  â”‚  âœ… 45ms avg    â”‚  âœ… 0.02%     â”‚  ğŸ”µ 23 running â”‚  âœ… 12 jobs   â”‚  â”‚
â”‚  â”‚  â†“ 5% vs yday   â”‚  â†“ 10%       â”‚  â†‘ 15%        â”‚  stable       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  ORGANIZATIONS         â”‚  â”‚  REVENUE (MTD)                     â”‚    â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”‚
â”‚  â”‚  Total: 156            â”‚  â”‚  MRR: $12,450                      â”‚    â”‚
â”‚  â”‚  Active: 142           â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  Trial: 8              â”‚  â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘  85%      â”‚   â”‚    â”‚
â”‚  â”‚  Churned (30d): 6      â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â”‚                        â”‚  â”‚  Stripe: $10,890 | Manual: $1,560 â”‚    â”‚
â”‚  â”‚  [View All â†’]          â”‚  â”‚  [View Details â†’]                 â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  SECURITY ALERTS                                        [View All]â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  âš ï¸  3 failed logins from unusual location - org: Acme    2m ago â”‚  â”‚
â”‚  â”‚  ğŸ”´  API key exposed in GitHub (detected) - org: TechCo   15m agoâ”‚  â”‚
â”‚  â”‚  âš ï¸  Unusual scan volume spike - org: SecureInc           1h ago â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  RECENT ADMIN ACTIVITY                                  [View All]â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  jane@a13e.io   â”‚ Suspended org "BadActor Inc"    â”‚ 10 min ago   â”‚  â”‚
â”‚  â”‚  john@a13e.io   â”‚ Impersonated user support@xyz   â”‚ 25 min ago   â”‚  â”‚
â”‚  â”‚  admin@a13e.io  â”‚ Created billing refund $49.99   â”‚ 1 hour ago   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.2 Organization Management

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Organizations                                          [+ Create Test] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Search: [________________________] [Status â–¼] [Tier â–¼] [Sort â–¼]       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ âœ… Acme Corporation                              ENTERPRISE         â”‚â”‚
â”‚  â”‚    ID: org_abc123... â”‚ Users: 45 â”‚ Accounts: 12 â”‚ Since: 2024-06   â”‚â”‚
â”‚  â”‚    MRR: $499/mo â”‚ Last active: 2 min ago                           â”‚â”‚
â”‚  â”‚    [View] [Impersonate Owner] [Suspend] [Audit Log]                â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ âš ï¸ Suspicious Activity Corp                      SUBSCRIBER        â”‚â”‚
â”‚  â”‚    ID: org_def456... â”‚ Users: 3 â”‚ Accounts: 87 â”‚ Since: 2024-12    â”‚â”‚
â”‚  â”‚    MRR: $29/mo â”‚ Last active: 5 min ago                            â”‚â”‚
â”‚  â”‚    âš ï¸ Alert: 87 cloud accounts added in 1 hour (unusual)           â”‚â”‚
â”‚  â”‚    [View] [Impersonate Owner] [Suspend] [Audit Log]                â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ğŸ”´ SUSPENDED: BadActor Inc                       FREE_SCAN         â”‚â”‚
â”‚  â”‚    ID: org_xyz789... â”‚ Users: 1 â”‚ Accounts: 0 â”‚ Since: 2024-12     â”‚â”‚
â”‚  â”‚    Suspended by: jane@a13e.io â”‚ Reason: ToS violation              â”‚â”‚
â”‚  â”‚    [View] [Unsuspend] [Delete] [Audit Log]                         â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.3 Organization Detail View

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Organizations    Acme Corporation                         ENTERPRISE â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [Overview] [Users] [Cloud Accounts] [Scans] [Billing] [Audit Log]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ORGANIZATION DETAILS                              [Edit] [JSON] â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  ID:            org_abc123-def4-5678-9012-abcdef012345           â”‚  â”‚
â”‚  â”‚  Slug:          acme-corp                                        â”‚  â”‚
â”‚  â”‚  Created:       2024-06-15 14:32:00 UTC                          â”‚  â”‚
â”‚  â”‚  Owner:         john.smith@acme.com                              â”‚  â”‚
â”‚  â”‚  Status:        âœ… Active                                        â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  SSO Provider:  Google Workspace                                 â”‚  â”‚
â”‚  â”‚  Domain:        acme.com (verified)                              â”‚  â”‚
â”‚  â”‚  MFA Required:  âœ… Enforced                                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  SUBSCRIPTION                                                     â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  Tier:          Enterprise                                       â”‚  â”‚
â”‚  â”‚  Price:         $499/month                                       â”‚  â”‚
â”‚  â”‚  Billing:       Stripe (cus_abc123)                              â”‚  â”‚
â”‚  â”‚  Next Invoice:  2025-01-15 ($499.00)                             â”‚  â”‚
â”‚  â”‚  Payment:       Visa ****4242                                    â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  [View in Stripe] [Apply Credit] [Cancel Subscription]          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  USAGE METRICS (Last 30 Days)                                    â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  Scans Run:     245                                              â”‚  â”‚
â”‚  â”‚  API Calls:     12,456                                           â”‚  â”‚
â”‚  â”‚  Detections:    1,892 discovered                                 â”‚  â”‚
â”‚  â”‚  Cloud Accounts: 12 connected                                    â”‚  â”‚
â”‚  â”‚  Data Scanned:  4.2 GB                                           â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ADMIN ACTIONS                                                    â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  [ğŸ”‘ Impersonate Owner]  [â¸ï¸ Suspend Org]  [ğŸ“§ Send Email]       â”‚  â”‚
â”‚  â”‚  [ğŸ“Š Export Data]        [ğŸ—‘ï¸ Delete Org]                         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.4 Metrics & Monitoring Dashboard

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Metrics & Monitoring                    [Last 24h â–¼] [Auto-refresh ğŸ”„]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  INFRASTRUCTURE HEALTH                                            â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  ECS Tasks    â”‚  RDS          â”‚  ElastiCache  â”‚  S3              â”‚  â”‚
â”‚  â”‚  âœ… 2/2 healthyâ”‚  âœ… 12% CPU   â”‚  âœ… 45% memory â”‚  âœ… 2.1TB used   â”‚  â”‚
â”‚  â”‚  CPU: 35%     â”‚  Connections:  â”‚  Hit rate:    â”‚  Objects: 1.2M   â”‚  â”‚
â”‚  â”‚  Mem: 62%     â”‚  23/100       â”‚  98.5%        â”‚  Requests: 45K/h â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  API PERFORMANCE                                                  â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  Requests/min  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  1,245       â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  p50 Latency: 45ms â”‚ p95: 120ms â”‚ p99: 450ms                     â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚  â”‚     ^                                                      â”‚ â”‚  â”‚
â”‚  â”‚  â”‚ 100 â”‚    â•­â”€â•®      â•­â”€â”€â•®                                     â”‚ â”‚  â”‚
â”‚  â”‚  â”‚     â”‚   â•±  â•²    â•±    â•²     â•­â”€â”€â•®                            â”‚ â”‚  â”‚
â”‚  â”‚  â”‚  50 â”‚â”€â”€â•±â”€â”€â”€â”€â•²â”€â”€â•±â”€â”€â”€â”€â”€â”€â•²â”€â”€â”€â•±    â•²â”€â”€â”€â”€â”€â”€â”€â”€                   â”‚ â”‚  â”‚
â”‚  â”‚  â”‚     â”‚                                                      â”‚ â”‚  â”‚
â”‚  â”‚  â”‚   0 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â”‚  â”‚
â”‚  â”‚  â”‚       00:00    06:00    12:00    18:00    Now              â”‚ â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  TOP ENDPOINTS (by request count)                                 â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  POST /api/v1/scans                     4,521 req  â”‚  avg: 2.3s  â”‚  â”‚
â”‚  â”‚  GET  /api/v1/coverage/{id}             3,892 req  â”‚  avg: 45ms  â”‚  â”‚
â”‚  â”‚  GET  /api/v1/detections                2,156 req  â”‚  avg: 89ms  â”‚  â”‚
â”‚  â”‚  POST /api/v1/auth/refresh              1,987 req  â”‚  avg: 12ms  â”‚  â”‚
â”‚  â”‚  GET  /api/v1/gaps                      1,456 req  â”‚  avg: 156ms â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ERROR RATES                                                      â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚  4xx Errors:  0.8%  â”‚  401: 234  â”‚  403: 45  â”‚  404: 89          â”‚  â”‚
â”‚  â”‚  5xx Errors:  0.02% â”‚  500: 12   â”‚  502: 3   â”‚  503: 0           â”‚  â”‚
â”‚  â”‚                                                                  â”‚  â”‚
â”‚  â”‚  Recent 5xx:                                                     â”‚  â”‚
â”‚  â”‚  - 500 @ POST /scans - "RDS connection timeout" - 5 min ago      â”‚  â”‚
â”‚  â”‚  - 502 @ GET /coverage - "Lambda cold start" - 2 hrs ago         â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.5 Security Incidents

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Security Incidents                                    [Export] [Rules] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [All] [Critical] [High] [Medium] [Resolved]           [Last 7 Days â–¼] â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ğŸ”´ CRITICAL â”‚ API Key Exposed in Public Repository                 â”‚â”‚
â”‚  â”‚                                                                     â”‚â”‚
â”‚  â”‚ Detected:    2025-12-19 14:32:00 UTC (15 min ago)                  â”‚â”‚
â”‚  â”‚ Org:         TechCorp Inc (org_xyz789)                              â”‚â”‚
â”‚  â”‚ User:        developer@techcorp.com                                 â”‚â”‚
â”‚  â”‚ Details:     API key 'ak_prod_...' found in GitHub public repo      â”‚â”‚
â”‚  â”‚              Repository: github.com/techcorp/app                    â”‚â”‚
â”‚  â”‚                                                                     â”‚â”‚
â”‚  â”‚ Auto-actions taken:                                                 â”‚â”‚
â”‚  â”‚   âœ… API key automatically revoked                                  â”‚â”‚
â”‚  â”‚   âœ… User notified via email                                        â”‚â”‚
â”‚  â”‚   âœ… Org owner notified                                             â”‚â”‚
â”‚  â”‚                                                                     â”‚â”‚
â”‚  â”‚ Status: OPEN                                                        â”‚â”‚
â”‚  â”‚ [Investigate] [Mark Resolved] [Escalate]                            â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ âš ï¸ HIGH â”‚ Brute Force Login Attempt Detected                        â”‚â”‚
â”‚  â”‚                                                                     â”‚â”‚
â”‚  â”‚ Detected:    2025-12-19 14:15:00 UTC (32 min ago)                  â”‚â”‚
â”‚  â”‚ Org:         Acme Corp (org_abc123)                                 â”‚â”‚
â”‚  â”‚ Target:      admin@acme.com                                         â”‚â”‚
â”‚  â”‚ Details:     47 failed login attempts from 3 IPs in 5 minutes       â”‚â”‚
â”‚  â”‚              IPs: 192.168.1.1, 10.0.0.1, 172.16.0.1                 â”‚â”‚
â”‚  â”‚              (All from TOR exit nodes)                              â”‚â”‚
â”‚  â”‚                                                                     â”‚â”‚
â”‚  â”‚ Auto-actions taken:                                                 â”‚â”‚
â”‚  â”‚   âœ… Account temporarily locked                                     â”‚â”‚
â”‚  â”‚   âœ… IPs added to temporary blocklist                               â”‚â”‚
â”‚  â”‚   âœ… User notified via email                                        â”‚â”‚
â”‚  â”‚                                                                     â”‚â”‚
â”‚  â”‚ Status: MONITORING                                                  â”‚â”‚
â”‚  â”‚ [Investigate] [Unlock Account] [Escalate]                           â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ ğŸŸ¡ MEDIUM â”‚ Unusual Geographic Login                                â”‚â”‚
â”‚  â”‚                                                                     â”‚â”‚
â”‚  â”‚ Detected:    2025-12-19 13:45:00 UTC (1 hour ago)                  â”‚â”‚
â”‚  â”‚ Org:         SecureInc (org_def456)                                 â”‚â”‚
â”‚  â”‚ User:        cto@secureinc.com                                      â”‚â”‚
â”‚  â”‚ Details:     Login from Russia (Moscow) - user normally in USA      â”‚â”‚
â”‚  â”‚              VPN not detected. Mobile device, new browser.          â”‚â”‚
â”‚  â”‚                                                                     â”‚â”‚
â”‚  â”‚ Status: RESOLVED - Confirmed legitimate travel                      â”‚â”‚
â”‚  â”‚ [View Details]                                                      â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4.6 Admin Audit Log

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Admin Audit Log                              [Export CSV] [Export JSON]â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Admin: [All â–¼]  Action: [All â–¼]  Date: [Last 7 Days â–¼]  [ğŸ” Search]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Timestamp    â”‚ Action                              â”‚ Admin         â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ 14:32:00     â”‚ ğŸ”‘ Started impersonation            â”‚ john@a13e.io  â”‚â”‚
â”‚  â”‚ Today        â”‚    User: support@acme.com           â”‚ IP: 10.0.0.1  â”‚â”‚
â”‚  â”‚              â”‚    Org: Acme Corp                   â”‚ Duration: 15m â”‚â”‚
â”‚  â”‚              â”‚    Reason: "Investigating scan bug" â”‚               â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ 14:15:00     â”‚ â¸ï¸ Suspended organization            â”‚ jane@a13e.io  â”‚â”‚
â”‚  â”‚ Today        â”‚    Org: BadActor Inc                â”‚ IP: 10.0.0.2  â”‚â”‚
â”‚  â”‚              â”‚    Reason: "ToS violation - abuse"  â”‚               â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ 13:45:00     â”‚ ğŸ’° Applied billing credit           â”‚ billing@a13e  â”‚â”‚
â”‚  â”‚ Today        â”‚    Org: TechCorp                    â”‚ IP: 10.0.0.3  â”‚â”‚
â”‚  â”‚              â”‚    Amount: $49.99                   â”‚               â”‚â”‚
â”‚  â”‚              â”‚    Reason: "Service outage credit"  â”‚               â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ 12:30:00     â”‚ ğŸ‘¤ Created new admin user           â”‚ cto@a13e.io   â”‚â”‚
â”‚  â”‚ Today        â”‚    Email: newadmin@a13e.io          â”‚ (super_admin) â”‚â”‚
â”‚  â”‚              â”‚    Role: support_admin              â”‚               â”‚â”‚
â”‚  â”‚              â”‚    Approved by: ceo@a13e.io         â”‚               â”‚â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤â”‚
â”‚  â”‚ 10:15:00     â”‚ ğŸ“Š Exported organization data       â”‚ john@a13e.io  â”‚â”‚
â”‚  â”‚ Today        â”‚    Org: Enterprise Co               â”‚ IP: 10.0.0.1  â”‚â”‚
â”‚  â”‚              â”‚    Format: JSON                     â”‚               â”‚â”‚
â”‚  â”‚              â”‚    Reason: "Compliance audit"       â”‚               â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                                                                          â”‚
â”‚  Showing 1-5 of 1,234 entries                      [â† Previous] [Next â†’]â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 5. API DESIGN

### 5.1 Admin API Routes

```python
# backend/app/api/routes/admin/

# Authentication (admin-specific)
POST   /admin/auth/login              # Admin login (email + password)
POST   /admin/auth/mfa/verify         # MFA verification (TOTP/WebAuthn)
POST   /admin/auth/mfa/webauthn/begin # Start WebAuthn flow
POST   /admin/auth/mfa/webauthn/complete
POST   /admin/auth/logout             # Logout (invalidate session)
POST   /admin/auth/refresh            # Refresh token
GET    /admin/auth/me                 # Current admin info

# Organizations
GET    /admin/organizations           # List all orgs (paginated)
GET    /admin/organizations/{id}      # Get org details
PATCH  /admin/organizations/{id}      # Update org (limited fields)
POST   /admin/organizations/{id}/suspend  # Suspend org
POST   /admin/organizations/{id}/unsuspend
DELETE /admin/organizations/{id}      # Delete org (requires approval)
GET    /admin/organizations/{id}/users
GET    /admin/organizations/{id}/cloud-accounts
GET    /admin/organizations/{id}/scans
GET    /admin/organizations/{id}/audit-log

# Users
GET    /admin/users                   # List all users (paginated)
GET    /admin/users/{id}              # Get user details
POST   /admin/users/{id}/disable      # Disable user account
POST   /admin/users/{id}/enable
POST   /admin/users/{id}/impersonate  # Start impersonation session
DELETE /admin/users/{id}/impersonate  # End impersonation

# Billing
GET    /admin/billing/overview        # Revenue metrics
GET    /admin/billing/subscriptions   # List subscriptions
GET    /admin/billing/subscriptions/{id}
POST   /admin/billing/subscriptions/{id}/credit  # Apply credit
POST   /admin/billing/subscriptions/{id}/refund  # Process refund
GET    /admin/billing/invoices

# Metrics
GET    /admin/metrics/system          # Infrastructure health
GET    /admin/metrics/api             # API performance
GET    /admin/metrics/usage           # Platform usage
GET    /admin/metrics/security        # Security metrics
GET    /admin/metrics/business        # Business metrics (ARR, churn)

# Security
GET    /admin/security/incidents      # List incidents
GET    /admin/security/incidents/{id}
POST   /admin/security/incidents/{id}/resolve
POST   /admin/security/incidents/{id}/escalate
GET    /admin/security/alerts         # Real-time alerts
GET    /admin/security/blocked-ips    # IP blocklist

# Audit
GET    /admin/audit-logs              # Admin audit log (self)
GET    /admin/audit-logs/export       # Export logs

# Admin Management (super_admin only)
GET    /admin/admins                  # List admin users
POST   /admin/admins                  # Create admin (requires approval)
GET    /admin/admins/{id}
PATCH  /admin/admins/{id}             # Update role
DELETE /admin/admins/{id}             # Delete admin (requires approval)
POST   /admin/admins/{id}/reset-mfa   # Reset MFA
```

### 5.2 Security Middleware

```python
# backend/app/api/middleware/admin_security.py

from fastapi import Request, HTTPException
from functools import wraps

class AdminSecurityMiddleware:
    """Security middleware for admin portal."""

    async def __call__(self, request: Request, call_next):
        # 1. Verify request is from allowed IP
        client_ip = self.get_client_ip(request)
        if not await self.is_ip_allowed(client_ip):
            await self.log_blocked_request(request, "ip_not_allowed")
            raise HTTPException(403, "Access denied")

        # 2. Verify admin JWT token
        token = self.extract_token(request)
        if not token:
            raise HTTPException(401, "Authentication required")

        admin = await self.verify_admin_token(token)
        if not admin:
            await self.log_blocked_request(request, "invalid_token")
            raise HTTPException(401, "Invalid or expired token")

        # 3. Verify session is still valid
        if not await self.verify_session(admin, request):
            await self.log_blocked_request(request, "session_invalid")
            raise HTTPException(401, "Session expired or invalid")

        # 4. Check rate limits
        if await self.is_rate_limited(admin.id):
            await self.log_blocked_request(request, "rate_limited")
            raise HTTPException(429, "Too many requests")

        # 5. Attach admin to request state
        request.state.admin = admin

        # 6. Process request and audit log
        response = await call_next(request)
        await self.create_audit_log(request, response, admin)

        return response

    async def is_ip_allowed(self, ip: str) -> bool:
        """Check IP against allowlist from secrets manager."""
        allowed_ips = await self.get_allowed_ips()
        return ip in allowed_ips or self.ip_in_cidr(ip, allowed_ips)

    async def verify_session(self, admin, request: Request) -> bool:
        """Verify session matches expected context."""
        session = await self.get_session(admin.session_id)

        # Verify IP hasn't changed
        if session.ip_address != self.get_client_ip(request):
            return False

        # Verify user-agent hasn't changed
        if session.user_agent != request.headers.get("User-Agent"):
            return False

        # Verify session hasn't expired
        if session.expires_at < datetime.now(timezone.utc):
            return False

        return True


def require_permission(permission: str):
    """Decorator to check admin has required permission."""
    def decorator(func):
        @wraps(func)
        async def wrapper(request: Request, *args, **kwargs):
            admin = request.state.admin

            if not has_permission(admin.role, permission):
                await create_audit_log(
                    admin_id=admin.id,
                    action=f"permission_denied:{permission}",
                    success=False,
                )
                raise HTTPException(403, f"Permission denied: {permission}")

            return await func(request, *args, **kwargs)
        return wrapper
    return decorator


def require_reauth(func):
    """Decorator requiring recent authentication for sensitive actions."""
    @wraps(func)
    async def wrapper(request: Request, *args, **kwargs):
        admin = request.state.admin

        # Check last authentication time
        if admin.last_auth_at < datetime.now(timezone.utc) - timedelta(minutes=5):
            raise HTTPException(
                401,
                "Re-authentication required for this action",
                headers={"X-Require-Reauth": "true"}
            )

        return await func(request, *args, **kwargs)
    return wrapper


def require_approval(action: str):
    """Decorator requiring approval from another admin."""
    def decorator(func):
        @wraps(func)
        async def wrapper(request: Request, *args, **kwargs):
            admin = request.state.admin
            body = await request.json()

            approval_id = body.get("approval_id")
            if not approval_id:
                # Create pending approval request
                approval = await create_approval_request(
                    admin_id=admin.id,
                    action=action,
                    resource_id=kwargs.get("id"),
                    expires_in=timedelta(hours=1),
                )
                raise HTTPException(
                    202,
                    {
                        "message": "Approval required",
                        "approval_id": str(approval.id),
                        "expires_at": approval.expires_at.isoformat(),
                    }
                )

            # Verify approval
            if not await verify_approval(approval_id, admin.id, action):
                raise HTTPException(403, "Invalid or expired approval")

            return await func(request, *args, **kwargs)
        return wrapper
    return decorator
```

---

## 6. DATA MODEL

### 6.1 Admin-Specific Tables

```sql
-- Admin users (separate from tenant users)
CREATE TABLE admin_users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    role admin_role NOT NULL DEFAULT 'readonly_admin',

    -- MFA
    mfa_enabled BOOLEAN DEFAULT false,
    mfa_secret_encrypted BYTEA,  -- TOTP secret, encrypted with AWS KMS
    webauthn_credentials JSONB DEFAULT '[]',  -- Array of credential IDs

    -- Security status
    is_active BOOLEAN DEFAULT true,
    locked_until TIMESTAMP,
    failed_login_attempts INTEGER DEFAULT 0,
    requires_password_change BOOLEAN DEFAULT true,
    last_password_change TIMESTAMP,

    -- Metadata
    full_name VARCHAR(255),
    created_at TIMESTAMP DEFAULT NOW(),
    created_by UUID REFERENCES admin_users(id),
    updated_at TIMESTAMP DEFAULT NOW(),
    last_login_at TIMESTAMP,

    CONSTRAINT valid_admin_email CHECK (email ~* '^[A-Za-z0-9._%+-]+@a13e\.(com|io)$')
);

-- Admin sessions
CREATE TABLE admin_sessions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    admin_id UUID NOT NULL REFERENCES admin_users(id) ON DELETE CASCADE,

    -- Session context (for binding)
    ip_address INET NOT NULL,
    user_agent TEXT,
    device_fingerprint VARCHAR(255),
    geo_location JSONB,

    -- Tokens
    refresh_token_hash VARCHAR(255) NOT NULL,

    -- Timing
    created_at TIMESTAMP DEFAULT NOW(),
    last_activity_at TIMESTAMP DEFAULT NOW(),
    expires_at TIMESTAMP NOT NULL,

    -- Status
    is_active BOOLEAN DEFAULT true,
    terminated_reason VARCHAR(50),  -- 'logout', 'expired', 'superseded', 'admin_action'

    INDEX idx_admin_sessions_admin (admin_id),
    INDEX idx_admin_sessions_expires (expires_at) WHERE is_active = true
);

-- Admin impersonation sessions
CREATE TABLE admin_impersonation_sessions (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    admin_id UUID NOT NULL REFERENCES admin_users(id),
    admin_session_id UUID NOT NULL REFERENCES admin_sessions(id),

    -- Target
    target_user_id UUID NOT NULL REFERENCES users(id),
    target_org_id UUID NOT NULL REFERENCES organizations(id),

    -- Audit
    reason TEXT NOT NULL,
    started_at TIMESTAMP DEFAULT NOW(),
    ended_at TIMESTAMP,
    max_duration_minutes INTEGER DEFAULT 30,

    -- Actions taken during impersonation
    actions_log JSONB DEFAULT '[]',

    CONSTRAINT valid_duration CHECK (max_duration_minutes <= 60)
);

-- Admin audit logs (immutable)
CREATE TABLE admin_audit_logs (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

    -- Who
    admin_id UUID NOT NULL REFERENCES admin_users(id),
    admin_email VARCHAR(255) NOT NULL,  -- Denormalized for search
    admin_role admin_role NOT NULL,

    -- What
    action VARCHAR(100) NOT NULL,
    resource_type VARCHAR(50),
    resource_id UUID,
    resource_name VARCHAR(255),

    -- Context
    ip_address INET NOT NULL,
    user_agent TEXT,
    device_fingerprint VARCHAR(255),
    geo_location JSONB,
    session_id UUID,

    -- Request
    request_id UUID NOT NULL,
    request_path VARCHAR(255),
    request_method VARCHAR(10),
    request_body_hash VARCHAR(64),  -- SHA-256

    -- Response
    response_status INTEGER,
    success BOOLEAN NOT NULL,
    error_message TEXT,

    -- Additional
    reason TEXT,
    approval_id UUID,
    impersonating_user_id UUID,

    -- Integrity
    timestamp TIMESTAMP DEFAULT NOW(),
    log_hash VARCHAR(64) NOT NULL,  -- SHA-256 of all fields
    previous_log_hash VARCHAR(64),  -- Chain for integrity

    INDEX idx_admin_audit_admin (admin_id),
    INDEX idx_admin_audit_action (action),
    INDEX idx_admin_audit_resource (resource_type, resource_id),
    INDEX idx_admin_audit_timestamp (timestamp DESC)
);

-- No UPDATE or DELETE policies on admin_audit_logs
ALTER TABLE admin_audit_logs ENABLE ROW LEVEL SECURITY;

CREATE POLICY audit_insert_only ON admin_audit_logs
    FOR INSERT WITH CHECK (true);

CREATE POLICY audit_select_only ON admin_audit_logs
    FOR SELECT USING (true);

-- Approval requests for sensitive actions
CREATE TABLE admin_approval_requests (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

    -- Requestor
    requestor_id UUID NOT NULL REFERENCES admin_users(id),

    -- Action details
    action VARCHAR(100) NOT NULL,
    resource_type VARCHAR(50),
    resource_id UUID,
    reason TEXT NOT NULL,

    -- Status
    status approval_status DEFAULT 'pending',  -- pending, approved, rejected, expired

    -- Approver
    approver_id UUID REFERENCES admin_users(id),
    approver_notes TEXT,

    -- Timing
    created_at TIMESTAMP DEFAULT NOW(),
    expires_at TIMESTAMP NOT NULL,
    resolved_at TIMESTAMP,

    CONSTRAINT different_approver CHECK (approver_id IS NULL OR approver_id != requestor_id)
);

-- Security incidents
CREATE TABLE security_incidents (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

    -- Classification
    severity incident_severity NOT NULL,  -- critical, high, medium, low
    type VARCHAR(100) NOT NULL,

    -- Affected entities
    organization_id UUID REFERENCES organizations(id),
    user_id UUID REFERENCES users(id),

    -- Details
    title VARCHAR(255) NOT NULL,
    description TEXT NOT NULL,
    evidence JSONB,

    -- Auto-actions
    auto_actions_taken JSONB DEFAULT '[]',

    -- Status
    status incident_status DEFAULT 'open',  -- open, investigating, resolved, false_positive

    -- Handling
    assigned_to UUID REFERENCES admin_users(id),
    resolved_by UUID REFERENCES admin_users(id),
    resolution_notes TEXT,

    -- Timing
    detected_at TIMESTAMP DEFAULT NOW(),
    acknowledged_at TIMESTAMP,
    resolved_at TIMESTAMP,

    INDEX idx_incidents_status (status, severity),
    INDEX idx_incidents_org (organization_id)
);

-- IP allowlist for admin portal
CREATE TABLE admin_ip_allowlist (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),

    ip_address CIDR NOT NULL,
    description VARCHAR(255),

    -- Audit
    created_at TIMESTAMP DEFAULT NOW(),
    created_by UUID REFERENCES admin_users(id),
    expires_at TIMESTAMP,  -- NULL = never expires

    is_active BOOLEAN DEFAULT true,

    UNIQUE(ip_address)
);
```

---

## 7. IMPLEMENTATION PLAN

### 7.1 Phase 1: Security Foundation (4-6 hours)

| Task | Description | Priority |
|------|-------------|----------|
| 1.1 | Create admin_users table and migrations | CRITICAL |
| 1.2 | Implement admin authentication (login, MFA) | CRITICAL |
| 1.3 | Implement IP allowlist middleware | CRITICAL |
| 1.4 | Create audit logging system | CRITICAL |
| 1.5 | Implement session management | CRITICAL |
| 1.6 | Set up separate admin API router | HIGH |

### 7.2 Phase 2: Core Features (3-4 hours)

| Task | Description | Priority |
|------|-------------|----------|
| 2.1 | Organization list/detail endpoints | HIGH |
| 2.2 | User management endpoints | HIGH |
| 2.3 | Suspend/unsuspend functionality | HIGH |
| 2.4 | Basic metrics endpoints | HIGH |

### 7.3 Phase 3: Advanced Features (3-4 hours)

| Task | Description | Priority |
|------|-------------|----------|
| 3.1 | Impersonation system | MEDIUM |
| 3.2 | Security incidents CRUD | MEDIUM |
| 3.3 | Billing overview integration | MEDIUM |
| 3.4 | Approval workflow | MEDIUM |

### 7.4 Phase 4: Frontend (4-6 hours)

| Task | Description | Priority |
|------|-------------|----------|
| 4.1 | Admin login page with MFA | CRITICAL |
| 4.2 | Dashboard overview | HIGH |
| 4.3 | Organization management pages | HIGH |
| 4.4 | Metrics dashboard | HIGH |
| 4.5 | Audit log viewer | MEDIUM |
| 4.6 | Security incidents page | MEDIUM |

### 7.5 Phase 5: Infrastructure (2-3 hours)

| Task | Description | Priority |
|------|-------------|----------|
| 5.1 | Separate CloudFront distribution | HIGH |
| 5.2 | WAF rules for admin domain | HIGH |
| 5.3 | S3 bucket for admin assets | HIGH |
| 5.4 | Terraform module for admin infra | HIGH |

---

## 8. SECURITY CHECKLIST

### Pre-Launch Security Review

- [ ] **Authentication**
  - [ ] MFA is mandatory (no bypass)
  - [ ] Password policy enforced (16+ chars, complexity)
  - [ ] Account lockout after failed attempts
  - [ ] Session timeout (15 min idle, 8 hour max)

- [ ] **Authorization**
  - [ ] All endpoints require authentication
  - [ ] Permission checks on every action
  - [ ] Sensitive actions require re-auth
  - [ ] Approval workflow for destructive actions

- [ ] **Network Security**
  - [ ] IP allowlist configured
  - [ ] WAF rules active
  - [ ] TLS 1.3 only
  - [ ] No public access to admin resources

- [ ] **Audit & Logging**
  - [ ] Every action logged
  - [ ] Logs are immutable (S3 Object Lock)
  - [ ] Log integrity verified (hash chain)
  - [ ] Alerts on suspicious activity

- [ ] **Data Protection**
  - [ ] Secrets in AWS Secrets Manager
  - [ ] MFA secrets encrypted with KMS
  - [ ] No sensitive data in logs
  - [ ] PII minimized

- [ ] **Incident Response**
  - [ ] Security incident detection rules
  - [ ] Auto-response for critical events
  - [ ] Escalation paths defined
  - [ ] Runbooks documented

---

## 9. FUTURE ENHANCEMENTS

### Not in MVP (Post-Launch)

1. **WebAuthn Support** - Hardware key MFA (FIDO2)
2. **SSO for Admins** - Okta/Azure AD integration
3. **Real-time Metrics** - WebSocket updates
4. **Custom Dashboards** - Grafana integration
5. **Automated Security Response** - More sophisticated auto-actions
6. **Admin API Keys** - For automation/scripting
7. **Multi-region Admin** - DR/failover

---

**Document Status:** Ready for implementation
**Next Step:** Begin Phase 1 (Security Foundation)
**Estimated Total Effort:** 16-23 hours

---

**Last Updated:** 2025-12-19
**Author:** Claude (Orchestrator CoT)
